
declare
    cur sys_refcursor;
begin
    OPEN cur FOR SELECT Contract_Package.GetServiceRecommendationsByContract(6, 3) FROM DUAL;
    dbms_sql.return_result(cur);
end;

SELECT SD.* FROM CONTRACT C
    INNER JOIN SERVICE S ON C.ID = S.CONTRACT_ID
    INNER JOIN SERVICE_DESCRIPTION SD on S.DESCRIPTION_ID = SD.ID
    WHERE C.ID = 6;

----------------------------------------------------------------------------------

/*
SELECT S.DESCRIPTION_ID FROM SERVICE S INNER JOIN
            CONTRACT C on S.CONTRACT_ID = C.ID WHERE C.ID = 111;

SELECT * FROM SERVICE_DESCRIPTION WHERE ID IN
    (SELECT ITEM_ID FROM DM$P4SERVICE_ASSOC_MODEL WHERE ITEMSET_ID IN
    (SELECT CONSEQUENT_ITEMSET_ID FROM (SELECT * FROM DM$P0SERVICE_ASSOC_MODEL
    WHERE ANTECEDENT_ITEMSET_ID = 14 ORDER BY LIFT DESC) WHERE ROWNUM <= 3));


SELECT ITEMSET_ID FROM DM$P4SERVICE_ASSOC_MODEL a
    WHERE NOT exists(SELECT S.DESCRIPTION_ID FROM SERVICE S INNER JOIN
                        CONTRACT C on S.CONTRACT_ID = C.ID WHERE C.ID = 111
                     MINUS
                    SELECT ITEM_ID FROM DM$P4SERVICE_ASSOC_MODEL a1
                        WHERE a.ITEMSET_ID = a1.ITEMSET_ID)
    GROUP BY ITEMSET_ID
    HAVING COUNT(ITEMSET_ID) =
                (SELECT COUNT(S.DESCRIPTION_ID) FROM SERVICE S INNER JOIN
                        CONTRACT C on S.CONTRACT_ID = C.ID WHERE C.ID = 111);
*/
